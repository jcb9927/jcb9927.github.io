<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Página en pruebas</title>
  <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f0f0;
      color: #333;
      margin: 2em;
    }
    #contenido {
      max-width: 800px;
      margin: auto;
      background-color: #fff;
      padding: 1em;
      border: 1px dashed #ccc;
      border-radius: 5px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <div id="contenido" style="display:none;"></div>

  <script>
    (function() {
      // Configuración: URL a la que redirigir si no hay acceso válido
      const URL_REDIRECCION = 'index.html';

      // Obtener parámetros de la URL
      const params = new URLSearchParams(window.location.search);
      const clave = params.get('clave');
      const datos = params.get('datos');

      // Verificar que se envió todo
      if (!clave || !datos) {
        window.location.href = URL_REDIRECCION;
        return;
      }

      try {
        // Intentar descifrar
        const decrypted = CryptoJS.AES.decrypt(datos, clave);
        const plaintext = decrypted.toString(CryptoJS.enc.Utf8);

        // Si la clave es incorrecta, plaintext será vacío
        if (!plaintext) {
          throw new Error('Descifrado vacío');
        }

        // Insertar contenido descifrado en el DIV
        const div = document.getElementById('contenido');
        div.innerHTML = plaintext;
        div.style.display = 'block';
      } catch (e) {
        // Si algo falla, redirigir sin explicaciones
        window.location.href = URL_REDIRECCION;
      }
    })();
  </script>
</body>
</html>
